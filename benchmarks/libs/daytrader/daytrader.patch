diff -urN daytrader/javaee6/assemblies/daytrader-ear/pom.xml /home/ruic/daytrader/javaee6/assemblies/daytrader-ear/pom.xml
--- daytrader/javaee6/assemblies/daytrader-ear/pom.xml	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/assemblies/daytrader-ear/pom.xml	2019-06-03 16:21:50.164662921 +1000
@@ -1,4 +1,20 @@
 <?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
 <project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <modelVersion>4.0.0</modelVersion>
diff -urN daytrader/javaee6/assemblies/daytrader-ear/src/main/java/org/apache/geronimo/daytrader/javaee6/App.java /home/ruic/daytrader/javaee6/assemblies/daytrader-ear/src/main/java/org/apache/geronimo/daytrader/javaee6/App.java
--- daytrader/javaee6/assemblies/daytrader-ear/src/main/java/org/apache/geronimo/daytrader/javaee6/App.java	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/assemblies/daytrader-ear/src/main/java/org/apache/geronimo/daytrader/javaee6/App.java	1970-01-01 10:00:00.000000000 +1000
@@ -1,13 +0,0 @@
-package org.apache.geronimo.daytrader.javaee6;
-
-/**
- * Hello world!
- *
- */
-public class App 
-{
-    public static void main( String[] args )
-    {
-        System.out.println( "Hello World!" );
-    }
-}
diff -urN daytrader/javaee6/assemblies/daytrader-ear/src/main/resources/META-INF/application.xml /home/ruic/daytrader/javaee6/assemblies/daytrader-ear/src/main/resources/META-INF/application.xml
--- daytrader/javaee6/assemblies/daytrader-ear/src/main/resources/META-INF/application.xml	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/assemblies/daytrader-ear/src/main/resources/META-INF/application.xml	2019-06-03 16:21:50.192662674 +1000
@@ -1,14 +1,26 @@
 <?xml version="1.0" encoding="UTF-8"?>
-<application xmlns="http://java.sun.com/xml/ns/javaee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_6.xsd" version="6">
-  <application-name>daytrader</application-name>
-  <description>DayTrader Stock Trading Performance Benchmark Sample</description>  
-  <display-name>DayTrader EAR</display-name> 
-  
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<application xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns="http://java.sun.com/xml/ns/javaee" xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/application_5.xsd" version="5">
   <module>
     <web>
       <web-uri>web.war</web-uri>
-      <context-root>/daytrader</context-root>
+      <context-root>/daytrader/</context-root>
     </web>
   </module>
- 
-</application>
\ No newline at end of file
+  <library-directory>lib</library-directory>
+</application>
diff -urN daytrader/javaee6/assemblies/pom.xml /home/ruic/daytrader/javaee6/assemblies/pom.xml
--- daytrader/javaee6/assemblies/pom.xml	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/assemblies/pom.xml	2019-06-03 16:21:50.140663135 +1000
@@ -1,4 +1,20 @@
 <?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
   <modelVersion>4.0.0</modelVersion>
   <parent>
@@ -16,4 +32,4 @@
    <modules>
     <module>daytrader-ear</module>
   </modules>
-</project>
\ No newline at end of file
+</project>
diff -urN daytrader/javaee6/modules/entities/pom.xml /home/ruic/daytrader/javaee6/modules/entities/pom.xml
--- daytrader/javaee6/modules/entities/pom.xml	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/entities/pom.xml	2019-06-03 16:21:57.272600103 +1000
@@ -1,4 +1,20 @@
 <?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
 <project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <modelVersion>4.0.0</modelVersion>
@@ -13,7 +29,7 @@
   
  <name>DayTrader :: Java EE 6 :: Modules - Entities</name>
   <description>Daytrader Java EE 6 Entities Module</description>
-  
+
   <dependencies>
         <dependency>
             <groupId>org.apache.geronimo.daytrader.javaee6</groupId>
@@ -80,7 +96,21 @@
             <scope>provided</scope>
         </dependency>
         <!-- end OpenJPA PCEnhancer depends -->
-    </dependencies>
+
+      <dependency>
+          <groupId>org.hibernate</groupId>
+          <artifactId>hibernate-entitymanager</artifactId>
+          <version>5.0.7.Final</version>
+          <scope>provided</scope>
+      </dependency>
+
+	<dependency>
+	<groupId>org.codehaus.plexus</groupId>
+	<artifactId>plexus-velocity</artifactId>
+	<version>1.1.8</version>
+	</dependency>
+
+  </dependencies>
  
   <build>
         <resources>
@@ -90,6 +120,23 @@
             </resource>
         </resources>
 
+	<plugins>
+
+         <plugin>
+            <groupId>org.apache.maven.plugins</groupId>
+            <artifactId>maven-remote-resources-plugin</artifactId>
+            <version>1.5</version>
+            <dependencies>
+              <dependency>
+                <groupId>org.apache.maven.shared</groupId>
+                <artifactId>maven-filtering</artifactId>
+                <version>1.2</version>
+              </dependency>
+            </dependencies>
+         </plugin>
+
+
+	</plugins>
         <!--  <plugins>
             <plugin>
                 <groupId>org.apache.maven.plugins</groupId>
diff -urN daytrader/javaee6/modules/entities/src/main/resources/META-INF/persistence.xml /home/ruic/daytrader/javaee6/modules/entities/src/main/resources/META-INF/persistence.xml
--- daytrader/javaee6/modules/entities/src/main/resources/META-INF/persistence.xml	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/entities/src/main/resources/META-INF/persistence.xml	2019-06-03 16:21:57.312599750 +1000
@@ -1,4 +1,5 @@
 <?xml version="1.0" encoding="UTF-8"?>
+
 <!--
   Licensed to the Apache Software Foundation (ASF) under one or more
   contributor license agreements.  See the NOTICE file distributed with
@@ -15,37 +16,28 @@
   See the License for the specific language governing permissions and
   limitations under the License.
 -->
-<persistence xmlns="http://java.sun.com/xml/ns/persistence" version="1.0">
+<persistence xmlns="http://java.sun.com/xml/ns/persistence"
+   xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" version="1.0"
+   xsi:schemaLocation="http://java.sun.com/xml/ns/persistence
+   http://java.sun.com/xml/ns/persistence/persistence_1_0.xsd">
 
     <persistence-unit transaction-type="JTA" name="daytrader">
-        <provider>org.apache.openjpa.persistence.PersistenceProviderImpl</provider>
-        <jta-data-source>jdbc/TradeDataSource</jta-data-source>  
-        <non-jta-data-source>jdbc/NoTxTradeDataSource</non-jta-data-source> 
-        
+        <provider>org.hibernate.ejb.HibernatePersistence</provider>
+
+               <jta-data-source>java:/jdbc/TradeDataSource</jta-data-source>
+
         <class>org.apache.geronimo.daytrader.javaee6.entities.AccountDataBean</class>
         <class>org.apache.geronimo.daytrader.javaee6.entities.AccountProfileDataBean</class>
         <class>org.apache.geronimo.daytrader.javaee6.entities.HoldingDataBean</class>
         <class>org.apache.geronimo.daytrader.javaee6.entities.OrderDataBean</class>
         <class>org.apache.geronimo.daytrader.javaee6.entities.QuoteDataBean</class>
         <exclude-unlisted-classes>true</exclude-unlisted-classes>
-        
+
         <properties>
-            <property name="openjpa.jdbc.DBDictionary" value="derby" /> 
-            <property name="openjpa.BrokerImpl" value="non-finalizing" />
-            <!-- To enable OpenJPA to generate foreign key constraints, comment out this line -->
-            <!-- <property name="openjpa.jdbc.MappingDefaults" value="ForeignKeyDeleteAction=restrict,JoinForeignKeyDeleteAction=restrict"/> -->
-            <property name="openjpa.jdbc.SynchronizeMappings" value="buildSchema(ForeignKeys=true)"/>
-            <property name="openjpa.Sequence" value="table(Table=OPENJPASEQ, Increment=100)"/>
-
-            <!--
-            <property name="openjpa.jdbc.DBDictionary" value="derby" />
-            <property name="openjpa.jdbc.MappingDefaults" value="ForeignKeyDeleteAction=restrict,JoinForeignKeyDeleteAction=restrict"/> 
-            <property name="openjpa.jdbc.UpdateManager" value="org.apache.openjpa.jdbc.kernel.OperationOrderUpdateManager(batchLimit=0)" />
-            <property name="openjpa.ConnectionDriverName" value="org.apache.commons.dbcp.BasicDataSource"/>
-            <property name="openjpa.ConnectionDriverName" value="org.apache.derby.jdbc.EmbeddedDriver"/>
-            <property name="openjpa.ConnectionURL" value="jdbc:derby:tradedb;create=true"/>
-            <property name="openjpa.ConnectionProperties" value="DriverClassName=org.apache.derby.jdbc.EmbeddedDriver,Url=jdbc:derby:tradedb;create=true,MaxActive=50,MaxWait=10000,Username=,Password="/>
-            -->
+          <property name="hibernate.transaction.auto_close_session" value="true"/>
+          <!-- <property name="hibernate.hbm2ddl.auto" value="update"/>   -->
+          <property name="hibernate.connection.autocommit" value="false"/>
+          <property name="hibernate.dialect" value="org.hibernate.dialect.H2Dialect"/>
         </properties>
     </persistence-unit>
 </persistence>
diff -urN daytrader/javaee6/modules/pom.xml /home/ruic/daytrader/javaee6/modules/pom.xml
--- daytrader/javaee6/modules/pom.xml	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/pom.xml	2019-06-03 16:21:57.116601483 +1000
@@ -1,4 +1,20 @@
 <?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
   <modelVersion>4.0.0</modelVersion>
   <parent>
@@ -20,4 +36,4 @@
     <module>utils</module>    
     <module>web</module>
   </modules>
-</project>
\ No newline at end of file
+</project>
diff -urN daytrader/javaee6/modules/utils/pom.xml /home/ruic/daytrader/javaee6/modules/utils/pom.xml
--- daytrader/javaee6/modules/utils/pom.xml	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/utils/pom.xml	2019-06-03 16:21:57.124601411 +1000
@@ -1,4 +1,20 @@
 <?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
 <project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <modelVersion>4.0.0</modelVersion>
diff -urN daytrader/javaee6/modules/utils/src/main/java/org/apache/geronimo/daytrader/javaee6/utils/TradeConfig.java /home/ruic/daytrader/javaee6/modules/utils/src/main/java/org/apache/geronimo/daytrader/javaee6/utils/TradeConfig.java
--- daytrader/javaee6/modules/utils/src/main/java/org/apache/geronimo/daytrader/javaee6/utils/TradeConfig.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/utils/src/main/java/org/apache/geronimo/daytrader/javaee6/utils/TradeConfig.java	2019-06-03 16:21:57.208600671 +1000
@@ -80,7 +80,7 @@
     public static int cachingType = NO_CACHING;
     
     /* Trade Database Scaling parameters*/
-    private static int MAX_USERS = 500;
+    private static int MAX_USERS = 50;
     private static int MAX_QUOTES = 1000;
 
     /* Trade Database specific paramters */
diff -urN daytrader/javaee6/modules/web/pom.xml /home/ruic/daytrader/javaee6/modules/web/pom.xml
--- daytrader/javaee6/modules/web/pom.xml	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/pom.xml	2019-06-03 16:21:50.300661718 +1000
@@ -1,4 +1,20 @@
 <?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
 <project xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd" xmlns="http://maven.apache.org/POM/4.0.0"
     xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
   <modelVersion>4.0.0</modelVersion>
@@ -16,6 +32,7 @@
   <packaging>war</packaging>
   
   <dependencies>
+    
   <dependency>
             <groupId>org.apache.myfaces.core</groupId>
             <artifactId>myfaces-api</artifactId>
@@ -39,6 +56,11 @@
         </dependency>
         <dependency>
             <groupId>org.apache.geronimo.specs</groupId>
+            <artifactId>geronimo-jcdi_1.0_spec</artifactId>
+            <scope>provided</scope>
+        </dependency>
+        <dependency>
+            <groupId>org.apache.geronimo.specs</groupId>
             <artifactId>geronimo-ejb_3.1_spec</artifactId>
             <scope>provided</scope>
         </dependency>
@@ -70,6 +92,7 @@
         <dependency>
                 <groupId>org.apache.taglibs</groupId>
                 <artifactId>taglibs-standard-jstlel</artifactId>
+            <version>1.2.5</version>
                 <scope>provided</scope>
         </dependency>
 
@@ -83,16 +106,31 @@
         -->
     </dependencies>
     <build>
-        <resources>
-            <resource>
-                <directory>${basedir}/src/main/resources</directory>
-                <filtering>true</filtering>
-            </resource>
-        </resources>   
         <plugins>
+            <plugin>
+                <groupId>org.apache.maven.plugins</groupId>
+                <artifactId>maven-resources-plugin</artifactId>
+                <version>2.7</version>
+                <dependencies>
+                    <dependency>
+                        <groupId>org.apache.maven.shared</groupId>
+                        <artifactId>maven-filtering</artifactId>
+                        <version>1.3</version>
+                    </dependency>
+                </dependencies>
+                <configuration>
+                    <resources>
+                        <resource>
+                            <directory>${basedir}/src/main/resources</directory>
+                            <filtering>true</filtering>
+                        </resource>
+                    </resources>
+                </configuration>
+            </plugin>
         <plugin>
                 <groupId>org.apache.maven.plugins</groupId>
                 <artifactId>maven-war-plugin</artifactId>
+		<version>2.1</version>
                 <configuration>                    
                     <resources>
                         <resource
@@ -128,6 +166,31 @@
                     </webResources>
                 </configuration>
             </plugin>   
+
+<!--
+            <plugin>
+            <groupId>org.apache.maven.plugins</groupId>
+            <artifactId>maven-ejb-plugin</artifactId>
+            <version>2.5.1</version>
+            <executions>
+                <execution>
+                    <id>JBossClient</id>
+                    <configuration>
+                        <ejbVersion>3.1</ejbVersion>
+                        <generateClient>true</generateClient>
+                        <clientIncludes>
+				<clientIncludes>/org/apache/geronimo/daytrader/**</clientIncludes>
+                        </clientIncludes>
+                    </configuration>
+                    <goals>
+                        <goal>ejb</goal>
+                    </goals>
+                </execution>
+            </executions>
+        </plugin>
+-->
+
+
             </plugins> 
     </build>
 </project>
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJDBCDirect.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJDBCDirect.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJDBCDirect.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJDBCDirect.java	2019-06-03 16:21:56.300608696 +1000
@@ -60,7 +60,7 @@
 
     private static String dsName = TradeConfig.DATASOURCE;
 
-    private static @Resource DataSource datasource = null;
+    private static DataSource datasource = null;
 
     private static BigDecimal ZERO = new BigDecimal(0.0);
 
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJEEDirect.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJEEDirect.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJEEDirect.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJEEDirect.java	2019-06-03 16:21:56.272608944 +1000
@@ -19,7 +19,7 @@
 import java.math.BigDecimal;
 import java.util.Collection;
 import java.util.ArrayList;
-import javax.naming.InitialContext;
+import javax.naming.*;
 import javax.transaction.UserTransaction;
 import javax.annotation.Resource;
 import javax.jms.*;
@@ -66,7 +66,7 @@
     private static String dsName = TradeConfig.DATASOURCE;
     
     
-    private static @Resource DataSource datasource;
+    private static DataSource datasource;
 
     
 
@@ -540,7 +540,7 @@
             conn = getConn();
             cancelOrder(conn, orderID);
             commit(conn);
-
+      
         } catch (Exception e) {
             Log.error("TradeDirect:cancelOrder -- error cancelling order: " + orderID, e);
             rollBack(conn, e);
@@ -1328,6 +1328,7 @@
                 + " new price = " + quoteData.getPrice());
 
             producer.send(message);
+		System.out.println(message.getText());
         } catch (Exception e) {
             throw e; // pass exception back
 
@@ -1440,7 +1441,7 @@
                 Log.traceEnter("TradeDirect:register - inSession(" + this.inSession + ")");
 
             conn = getConn();
-            PreparedStatement stmt = getStatement(conn, createAccountSQL);
+            PreparedStatement stmt; // = getStatement(conn, createAccountSQL);
 
             Integer accountID = KeySequenceDirect.getNextID(conn, "account", inSession, getInGlobalTxn());
             BigDecimal balance = openBalance;
@@ -1449,6 +1450,17 @@
             int loginCount = 0;
             int logoutCount = 0;
 
+            stmt = getStatement(conn, createAccountProfileSQL);
+            stmt.setString(1, userID);
+            stmt.setString(2, password);
+            stmt.setString(3, fullname);
+            stmt.setString(4, address);
+            stmt.setString(5, email);
+            stmt.setString(6, creditcard);
+            stmt.executeUpdate();
+            stmt.close();
+
+stmt = getStatement(conn, createAccountSQL);
             stmt.setInt(1, accountID.intValue());
             stmt.setTimestamp(2, creationDate);
             stmt.setBigDecimal(3, openBalance);
@@ -1460,6 +1472,7 @@
             stmt.executeUpdate();
             stmt.close();
 
+/*
             stmt = getStatement(conn, createAccountProfileSQL);
             stmt.setString(1, userID);
             stmt.setString(2, password);
@@ -1469,7 +1482,7 @@
             stmt.setString(6, creditcard);
             stmt.executeUpdate();
             stmt.close();
-
+*/
             commit(conn);
 
             accountData =
@@ -1853,7 +1866,7 @@
        if (datasource == null)
             getDataSource();
         conn = datasource.getConnection();
-        conn.setAutoCommit(false);
+	//if (getInGlobalTxn() == false)        conn.setAutoCommit(false);
         if (Log.doTrace()) {
             synchronized (lock) {
                 connCount++;
@@ -2034,9 +2047,12 @@
             TradeConfig.setPublishQuotePriceChange(false);
         }
 
+
         try {
-            queue = (Queue) context.lookup("java:comp/env/jms/TradeBrokerQueue");
+
+            queue = (Queue) context.lookup("java:/queue/TradeBrokerQueue");
         } catch (Exception e) {
+		e.printStackTrace();
             Log
                 .error("TradeDirect:init  Unable to locate TradeBrokerQueue.\n\t -- Asynchronous mode will not work correctly and Quote Price change publishing will be disabled");
             TradeConfig.setPublishQuotePriceChange(false);
@@ -2051,7 +2067,7 @@
         }
 
         try {
-            streamerTopic = (Topic) context.lookup("java:comp/env/jms/TradeStreamerTopic");
+            streamerTopic = (Topic) context.lookup("java:/topic/TradeStreamerTopic");
         } catch (Exception e) {
             Log
                 .error("TradeDirect:init  Unable to locate TradeStreamerTopic.\n\t -- Asynchronous mode will not work correctly and Quote Price change publishing will be disabled");
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJPADirect.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJPADirect.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJPADirect.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/core/direct/TradeJPADirect.java	2019-06-03 16:21:56.316608556 +1000
@@ -717,8 +717,8 @@
         Query query = entityManager.createNamedQuery("holdingejb.holdingsByUserID");
         query.setParameter("userID", userID);
 
-        entityManager.getTransaction().commit();
         Collection<HoldingDataBean> holdings = query.getResultList();
+        entityManager.getTransaction().commit();
         /*
          * Inflate the lazy data memebers
          */
@@ -922,7 +922,7 @@
         if (Log.doTrace())
             Log.trace("TradeJPADirect:resetTrade", deleteAll);
 
-        return(new TradeJDBCDirect(false)).resetTrade(deleteAll);
+        return(new TradeJDBCDirect(true)).resetTrade(deleteAll);
     }
 
     /*
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/DirectSLSBBean.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/DirectSLSBBean.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/DirectSLSBBean.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/DirectSLSBBean.java	2019-06-03 16:21:56.976602720 +1000
@@ -27,7 +27,7 @@
 import javax.ejb.*;
 
 
-@Singleton
+@Stateless
 @EJB(name="java:global/DirectSLSBBean", beanInterface=DirectSLSBRemote.class)
 @TransactionAttribute(TransactionAttributeType.REQUIRED)
 @TransactionManagement(TransactionManagementType.CONTAINER)
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/TradeSLSBBean.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/TradeSLSBBean.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/TradeSLSBBean.java	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ejb3/TradeSLSBBean.java	2019-06-03 16:21:57.000602508 +1000
@@ -43,14 +43,12 @@
 import javax.ejb.*;
 import javax.jms.*;
 
-import javax.persistence.EntityManager;
-import javax.persistence.PersistenceContext;
-import javax.persistence.Query;
+import javax.persistence.*;
 
 import javax.transaction.RollbackException;
 
 
-@Singleton
+@Stateless
 @EJB(name="java:global/TradeSLSBBean",beanInterface=TradeSLSBRemote.class)
 @TransactionAttribute(TransactionAttributeType.REQUIRED)
 @TransactionManagement(TransactionManagementType.CONTAINER)
@@ -75,6 +73,7 @@
     public TradeSLSBBean() {
         if (Log.doTrace())
             Log.trace("TradeSLSBBean:ejbCreate  -- JNDI lookups of EJB and JMS resources");
+
     }
 
     public MarketSummaryDataBean getMarketSummary() {
@@ -599,7 +598,7 @@
             profile.setAccount(account);
             account.setProfile(profile);
 
-            entityManager.persist(profile); 
+            entityManager.persist(profile);
             entityManager.persist(account);
         }
         
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Entity.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Entity.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Entity.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Entity.java	1970-01-01 10:00:00.000000000 +1000
@@ -1,105 +0,0 @@
-/**
- *  Licensed to the Apache Software Foundation (ASF) under one or more
- *  contributor license agreements.  See the NOTICE file distributed with
- *  this work for additional information regarding copyright ownership.
- *  The ASF licenses this file to You under the Apache License, Version 2.0
- *  (the "License"); you may not use this file except in compliance with
- *  the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- *  Unless required by applicable law or agreed to in writing, software
- *  distributed under the License is distributed on an "AS IS" BASIS,
- *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- *  See the License for the specific language governing permissions and
- *  limitations under the License.
- */
-package org.apache.geronimo.daytrader.javaee6.web.prims.ejb3;
-
-import java.io.*;
-import javax.servlet.*;
-import javax.servlet.http.*;
-import javax.servlet.annotation.WebServlet;
-
-import javax.persistence.EntityManager;
-import javax.persistence.PersistenceContext;
-import javax.ejb.EJB;
-
-
-import org.apache.geronimo.daytrader.javaee6.entities.QuoteDataBean;
-import org.apache.geronimo.daytrader.javaee6.utils.Log;
-import org.apache.geronimo.daytrader.javaee6.utils.TradeConfig;
-
-/**
- * 
- * Primitive designed to run within the TradeApplication and makes use of
- * {@link trade_client.TradeConfig} for config parameters and random stock
- * symbols. Servlet will generate a random stock symbol and get the price of
- * that symbol using a {@link trade.Quote} Entity EJB This tests the common path
- * of a Servlet calling an Entity EJB to get data
- * 
- */
-@WebServlet("/ejb3/PingServlet2Entity")
-public class PingServlet2Entity extends HttpServlet {
-    private static String initTime;
-
-    private static int hitCount;
-    
-    private @EJB QuoteDataBean quote;
-
-    @PersistenceContext(unitName = "daytrader")
-    private EntityManager em;
-
-    public void doPost(HttpServletRequest req, HttpServletResponse res) throws ServletException, IOException {
-        doGet(req, res);
-    }
-
-    public void doGet(HttpServletRequest req, HttpServletResponse res) throws IOException, ServletException {
-
-        res.setContentType("text/html");
-        java.io.PrintWriter out = res.getWriter();
-
-        String symbol = null;
-
-        StringBuffer output = new StringBuffer(100);
-        output.append("<html><head><title>Servlet2Entity</title></head>" + "<body><HR><FONT size=\"+2\" color=\"#000066\">PingServlet2Entity<BR></FONT>" + "<FONT size=\"-1\" color=\"#000066\"><BR>PingServlet2Entity accesses an EntityManager"
-                + " using a PersistenceContext annotaion and then gets the price of a random symbol (generated by TradeConfig)" + " through the EntityManager find method");
-        try {
-            // generate random symbol
-            try {
-                int iter = TradeConfig.getPrimIterations();
-                for (int ii = 0; ii < iter; ii++) {
-                    // get a random symbol to look up and get the key to that
-                    // symbol.
-                    symbol = TradeConfig.rndSymbol();
-                    // find the EntityInstance.
-                    quote = (QuoteDataBean) em.find(QuoteDataBean.class, symbol);
-                }
-            } catch (Exception e) {
-                Log.error("web_primtv.PingServlet2Entity.doGet(...): error performing find");
-                throw e;
-            }
-            // get the price and print the output.
-            output.append("<HR>initTime: " + initTime + "<BR>Hit Count: ").append(hitCount++);
-            output.append("<HR>Quote Information<BR><BR> " + quote.toHTML());
-            output.append("</font><HR></body></html>");
-            out.println(output.toString());
-        } catch (Exception e) {
-            Log.error(e, "PingServlet2Entity.doGet(...): error");
-            // this will send an Error to teh web applications defined error
-            // page.
-            res.sendError(500, "PingServlet2Entity.doGet(...): error" + e.toString());
-
-        }
-    }
-
-    public String getServletInfo() {
-        return "web primitive, tests Servlet to Entity EJB path";
-    }
-
-    public void init(ServletConfig config) throws ServletException {
-        super.init(config);
-        hitCount = 0;
-        initTime = new java.util.Date().toString();
-    }
-}
\ No newline at end of file
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2Many.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2Many.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2Many.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2Many.java	2019-06-03 16:21:56.616605903 +1000
@@ -98,4 +98,4 @@
         hitCount = 0;
         initTime = new java.util.Date().toString();
     }
-}
\ No newline at end of file
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2One.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2One.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2One.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2CMROne2One.java	2019-06-03 16:21:56.660605514 +1000
@@ -89,4 +89,4 @@
         hitCount = 0;
         initTime = new java.util.Date().toString();
     }
-}
\ No newline at end of file
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2EntityCollection.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2EntityCollection.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2EntityCollection.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2EntityCollection.java	2019-06-03 16:21:56.680605337 +1000
@@ -105,4 +105,4 @@
         hitCount = 0;
         initTime = new java.util.Date().toString();
     }
-}
\ No newline at end of file
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2Entity.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2Entity.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2Entity.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session2Entity.java	2019-06-03 16:21:56.628605797 +1000
@@ -96,4 +96,4 @@
         hitCount = 0;
         initTime = new java.util.Date().toString();
     }
-}
\ No newline at end of file
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2Session.java	2019-06-03 16:21:56.696605196 +1000
@@ -103,4 +103,4 @@
         initTime = new java.util.Date().toString();
 
     }
-}
\ No newline at end of file
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2TwoPhase.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2TwoPhase.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2TwoPhase.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/prims/ejb3/PingServlet2TwoPhase.java	2019-06-03 16:21:56.668605443 +1000
@@ -98,4 +98,4 @@
         hitCount = 0;
         initTime = new java.util.Date().toString();
     }
-}
\ No newline at end of file
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java	2019-06-03 16:21:56.424607600 +1000
@@ -0,0 +1,21 @@
+/**
+ *  Licensed to the Apache Software Foundation (ASF) under one or more
+ *  contributor license agreements.  See the NOTICE file distributed with
+ *  this work for additional information regarding copyright ownership.
+ *  The ASF licenses this file to You under the Apache License, Version 2.0
+ *  (the "License"); you may not use this file except in compliance with
+ *  the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing, software
+ *  distributed under the License is distributed on an "AS IS" BASIS,
+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ *  See the License for the specific language governing permissions and
+ *  limitations under the License.
+ */
+package org.apache.geronimo.daytrader.javaee6.web;
+
+public class ServiceImpl implements Service {
+
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java.rej /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java.rej
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java.rej	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/ServiceImpl.java.rej	2019-06-03 16:21:56.396607848 +1000
@@ -0,0 +1,24 @@
+***************
+*** 0 ****
+--- 1,21 ----
++ /**
++  *  Licensed to the Apache Software Foundation (ASF) under one or more
++  *  contributor license agreements.  See the NOTICE file distributed with
++  *  this work for additional information regarding copyright ownership.
++  *  The ASF licenses this file to You under the Apache License, Version 2.0
++  *  (the "License"); you may not use this file except in compliance with
++  *  the License.  You may obtain a copy of the License at
++  *
++  *     http://www.apache.org/licenses/LICENSE-2.0
++  *
++  *  Unless required by applicable law or agreed to in writing, software
++  *  distributed under the License is distributed on an "AS IS" BASIS,
++  *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
++  *  See the License for the specific language governing permissions and
++  *  limitations under the License.
++  */
++ package org.apache.geronimo.daytrader.javaee6.web;
++ 
++ public class ServiceImpl implements Service {
++ 
++ }
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java	2019-06-03 16:21:56.736604842 +1000
@@ -0,0 +1,21 @@
+/**
+ *  Licensed to the Apache Software Foundation (ASF) under one or more
+ *  contributor license agreements.  See the NOTICE file distributed with
+ *  this work for additional information regarding copyright ownership.
+ *  The ASF licenses this file to You under the Apache License, Version 2.0
+ *  (the "License"); you may not use this file except in compliance with
+ *  the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing, software
+ *  distributed under the License is distributed on an "AS IS" BASIS,
+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ *  See the License for the specific language governing permissions and
+ *  limitations under the License.
+ */
+package org.apache.geronimo.daytrader.javaee6.web;
+
+public interface Service {
+
+}
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java.rej /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java.rej
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java.rej	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/Service.java.rej	2019-06-03 16:21:56.928603145 +1000
@@ -0,0 +1,24 @@
+***************
+*** 0 ****
+--- 1,21 ----
++ /**
++  *  Licensed to the Apache Software Foundation (ASF) under one or more
++  *  contributor license agreements.  See the NOTICE file distributed with
++  *  this work for additional information regarding copyright ownership.
++  *  The ASF licenses this file to You under the Apache License, Version 2.0
++  *  (the "License"); you may not use this file except in compliance with
++  *  the License.  You may obtain a copy of the License at
++  *
++  *     http://www.apache.org/licenses/LICENSE-2.0
++  *
++  *  Unless required by applicable law or agreed to in writing, software
++  *  distributed under the License is distributed on an "AS IS" BASIS,
++  *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
++  *  See the License for the specific language governing permissions and
++  *  limitations under the License.
++  */
++ package org.apache.geronimo.daytrader.javaee6.web;
++ 
++ public interface Service {
++ 
++ }
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeAction.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeAction.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeAction.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeAction.java	2019-06-03 16:21:56.892603463 +1000
@@ -86,6 +86,7 @@
                     } catch (Exception ex) {
                         Log.error("TradeAction:createTrade - Lookup of TradeSLSBRemote failed!!!");
                         trade = (TradeServices) context.lookup("java:global/TradeSLSBBean");
+			System.out.println("found TradeSLSBBean");
                     }
                 }
             }
@@ -104,6 +105,7 @@
                     } catch (Exception ex) {
                         Log.error("TradeAction:createTrade - Lookup of DirectSLSBRemote failed!!!");
                         trade = (TradeServices) context.lookup("java:global/DirectSLSBBean");
+			System.out.println("Got DirectDLSBBean");
                     }
                 }
             }
@@ -113,7 +115,7 @@
             }
         } else if (TradeConfig.runTimeMode == TradeConfig.DIRECT) {
             try {
-                trade = new TradeJEEDirect();
+                trade = new TradeJEEDirect(true);
             }
             catch (Exception e) {
                 Log.error("TradeAction:TradeAction() Creation of Trade JDBC Direct failed\n" + e);
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeBuildDB.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeBuildDB.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeBuildDB.java	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeBuildDB.java	2019-06-03 16:21:56.940603038 +1000
@@ -1,11 +1,32 @@
+/**
+ *  Licensed to the Apache Software Foundation (ASF) under one or more
+ *  contributor license agreements.  See the NOTICE file distributed with
+ *  this work for additional information regarding copyright ownership.
+ *  The ASF licenses this file to You under the Apache License, Version 2.0
+ *  (the "License"); you may not use this file except in compliance with
+ *  the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ *  Unless required by applicable law or agreed to in writing, software
+ *  distributed under the License is distributed on an "AS IS" BASIS,
+ *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ *  See the License for the specific language governing permissions and
+ *  limitations under the License.
+ */
+
 package org.apache.geronimo.daytrader.javaee6.web;
 
+
+
 import java.io.BufferedReader;
 import java.io.File;
 import java.io.FileReader;
 import java.io.IOException;
 import java.math.BigDecimal;
 import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.List;
 
 import org.apache.geronimo.daytrader.javaee6.core.api.*;
 import org.apache.geronimo.daytrader.javaee6.core.direct.*;
@@ -17,11 +38,11 @@
 import org.apache.geronimo.daytrader.javaee6.utils.*;
 
 /**
- * TradeBuildDB uses operations provided by the TradeApplication to 
- *   (a) create the Database tables 
- *   (b) populate a DayTrader database without creating the tables. 
+ * TradeBuildDB uses operations provided by the TradeApplication to
+ *   (a) create the Database tables
+ *   (b) populate a DayTrader database without creating the tables.
  * Specifically, a new DayTrader User population is created using
- * UserIDs of the form "uid:xxx" where xxx is a sequential number 
+ * UserIDs of the form "uid:xxx" where xxx is a sequential number
  * (e.g. uid:0, uid:1, etc.). New stocks are also created of the form "s:xxx",
  * again where xxx represents sequential numbers (e.g. s:1, s:2, etc.)
  */
@@ -38,7 +59,7 @@
     }
 
     /**
-     * Re-create the DayTrader db tables and populate them OR just populate a 
+     * Re-create the DayTrader db tables and populate them OR just populate a
      * DayTrader DB, logging to the provided output stream
      */
     public TradeBuildDB(java.io.PrintWriter out, String warPath)
@@ -60,7 +81,7 @@
                 || (TradeConfig.getRunTimeMode() == TradeConfig.JPA)) {
                 tradeDB = new TradeJDBCDirect();
             } else {
-                tradeDB = new TradeJEEDirect();
+                tradeDB = new TradeJEEDirect(true);
             }
 
             boolean success = false;
@@ -97,13 +118,13 @@
                     ddlFile = new File(warPath + File.separatorChar + "dbscripts"
                         + File.separatorChar + "mysql" + File.separatorChar + "Table.ddl");
                 } else if (dbProductName.startsWith("Informix Dynamic Server")) { // if the Db is Informix dynamic server
-                    ddlFile = new File(warPath + File.separatorChar + "dbscripts" 
+                    ddlFile = new File(warPath + File.separatorChar + "dbscripts"
                         + File.separatorChar + "informix" + File.separatorChar + "Table.ddl");
                 } else if (dbProductName.startsWith("Microsoft SQL Server")) { // if the Db is Microsoft SQLServer
-                    ddlFile = new File(warPath + File.separatorChar + "dbscripts" 
+                    ddlFile = new File(warPath + File.separatorChar + "dbscripts"
                         + File.separatorChar + "sqlserver" + File.separatorChar + "Table.ddl");
                 } else if (dbProductName.startsWith("PostgreSQL")) { // if the Db is PostgreSQL
-                    ddlFile = new File(warPath + File.separatorChar + "dbscripts" 
+                    ddlFile = new File(warPath + File.separatorChar + "dbscripts"
                             + File.separatorChar + "postgre" + File.separatorChar + "Table.ddl");
                 } else { // Unsupported "Other" Database
                     ddlFile = new File(warPath + File.separatorChar + "dbscripts"
@@ -201,6 +222,30 @@
                 }
             }
         }
+
+        // Create some Fake stocks
+        List<String> tickers = Arrays.asList(
+            "BABO",
+            "TODD",
+            "ACME",
+            "FALK",
+            "PETE",
+            "BURR",
+            "JIM",
+            "OCRL",
+            "RTH",
+            "IMB"
+        );
+        try {
+          for (String ticker : tickers) {
+            tradeAction.createQuote(ticker, ticker + " Inc.",
+                            new java.math.BigDecimal(TradeConfig.rndPrice()));
+            out.print("....." + ticker);
+          }
+        } catch (Exception e) {
+            Log.error(e, "Can't create fake stocks");
+        }
+
         out.println("<BR>");
         out.println("<BR>**** Registering " + TradeConfig.getMAX_USERS()
             + " Users **** ");
@@ -224,13 +269,13 @@
                         email, creditcard, new BigDecimal(initialBalance));
                 String results;
                 if (accountData != null) {
-                    if (i % 50 == 0) {
+                    if (i % 10 == 0) {
                         out.print("<BR>Account# " + accountData.getAccountID()
                             + " userID=" + userID);
                     }
 
                     // 0-MAX_HOLDING (inclusive), avg holdings per user = (MAX-0)/2
-                    int holdings = TradeConfig.rndInt(TradeConfig.getMAX_HOLDINGS() + 1); 
+                    int holdings = TradeConfig.rndInt(TradeConfig.getMAX_HOLDINGS() + 1);
                     double quantity = 0;
                     OrderDataBean orderData;
                     for (int j = 0; j < holdings; j++) {
@@ -240,7 +285,7 @@
                             tradeAction.buy(userID, symbol, quantity,
                                 TradeConfig.orderProcessingMode);
                     }
-                    if (i % 50 == 0) {
+                    if (i % 10 == 0) {
                         out.println(" has " + holdings + " holdings.");
                         out.flush();
                     }
@@ -311,4 +356,3 @@
 
     }
 }
-
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeConfigServlet.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeConfigServlet.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeConfigServlet.java	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeConfigServlet.java	2019-06-03 16:21:56.908603321 +1000
@@ -23,13 +23,16 @@
 
 import org.apache.geronimo.daytrader.javaee6.core.direct.*;
 import org.apache.geronimo.daytrader.javaee6.core.beans.*;
+import org.apache.geronimo.daytrader.javaee6.dacapo.DaCapoClient;
+import org.apache.geronimo.daytrader.javaee6.dacapo.DaCapoDBBuilder;
 import org.apache.geronimo.daytrader.javaee6.utils.*;
+import org.apache.geronimo.daytrader.javaee6.web.ejb3.TradeSLSBBean;
 
 import java.io.IOException;
 
 /**
  * TradeConfigServlet provides a servlet interface to adjust DayTrader runtime parameters.
- * TradeConfigServlet updates values in the {@link org.apache.geronimo.samples.daytrader.web.TradeConfig} JavaBean holding 
+ * TradeConfigServlet updates values in the {@link TradeConfig} JavaBean holding
  * all configuration and runtime parameters for the Trade application
  *
  */
@@ -126,7 +129,19 @@
             } // If the value is bad, simply revert to current
         }
         currentConfigStr += "\t\tRunTimeMode:\t\t" + TradeConfig.runTimeModeNames[TradeConfig.getRunTimeMode()] + "\n";
-        
+
+        String traceStr = req.getParameter("EnableTrace");
+        if (traceStr != null && traceStr.equalsIgnoreCase("on"))
+        {
+            TradeConfig.setTrace(true);
+            TradeConfig.setActionTrace(true);
+        } else {
+            TradeConfig.setTrace(false);
+            TradeConfig.setActionTrace(false);
+        }
+        currentConfigStr += "\t\tTrace:\t\t" + TradeConfig.getTrace() + "\n";
+
+
         /* Add JPA layer choice to avoid some ugly Hibernate bugs */
         String jpaLayerStr = req.getParameter("JPALayer");
         if (jpaLayerStr != null)
@@ -174,7 +189,7 @@
         currentConfigStr += "\t\tOrderProcessingMode:\t" + TradeConfig.orderProcessingModeNames[TradeConfig.orderProcessingMode]  + "\n";        
         
         //String accessModeStr = req.getParameter("AcessMode");
-        String accessModeStr = "Standard";
+        String accessModeStr = "0";
         if (accessModeStr != null)
         {
             try
@@ -384,6 +399,8 @@
         throws ServletException, IOException {
 
         String action = null;
+        String size;
+        String bean;
         String result = "";
         
         resp.setContentType("text/html");
@@ -416,6 +433,16 @@
                 resp.setContentType("text/html");
                 new TradeBuildDB(resp.getWriter(), getServletConfig().getServletContext().getRealPath("/"));
             }
+            else if (action.equals("dacapoBuild"))
+            {
+                size = req.getParameter("size");
+                bean = req.getParameter("bean");
+                DaCapoClient.main(new String[] {"-i", "-s", size, bean});
+            } else if (action.equals("dacapoRun")){
+                size = req.getParameter("size");
+                bean = req.getParameter("bean");
+                DaCapoClient.main(new String[] {"-s", size, bean});
+            }
             doConfigDisplay(req, resp, result + "Current DayTrader Configuration:");
         }
         catch (Exception e)
diff -urN daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeServletAction.java /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeServletAction.java
--- daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeServletAction.java	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/java/org/apache/geronimo/daytrader/javaee6/web/TradeServletAction.java	2019-06-03 16:21:56.876603604 +1000
@@ -30,6 +30,7 @@
 import java.util.Collection;
 import java.util.Iterator;
 import java.util.ArrayList;
+import java.util.List;
 import java.math.BigDecimal;
 
 
@@ -90,7 +91,7 @@
             AccountDataBean accountData = tAction.getAccountData(userID);
             AccountProfileDataBean accountProfileData = tAction
                     .getAccountProfileData(userID);
-            ArrayList orderDataBeans = (TradeConfig.getLongRun() ? new ArrayList() : (ArrayList) tAction.getOrders(userID));
+            List orderDataBeans = (TradeConfig.getLongRun() ? new ArrayList() : (List)tAction.getOrders(userID));
             
             req.setAttribute("accountData", accountData);
             req.setAttribute("accountProfileData", accountProfileData);
@@ -323,7 +324,7 @@
             // JavaEE we should catch a javax.ejb.FinderException while
             // for non-JavaEE we should catch a RuntimeException
             try {
-                Class c = Class.forName("javax.ejb.FinderException");
+                Class c = javax.ejb.FinderException.class;
                 javaee = true;
                 if ((c != null) && (e instanceof javax.ejb.FinderException)) { // JavaEE container
                     // this is a user error so I will
@@ -340,7 +341,7 @@
                         + "treating this as a user error and forwarding on to a new page",
                         e);
                 }
-            } catch (ClassNotFoundException cnne) {
+            } catch (Exception cnne) {
                 // ignore, for the non-JavaEE web-only assemblies
             }
             
diff -urN daytrader/javaee6/modules/web/src/main/resources/dbscripts/mysql/Table.ddl /home/ruic/daytrader/javaee6/modules/web/src/main/resources/dbscripts/mysql/Table.ddl
--- daytrader/javaee6/modules/web/src/main/resources/dbscripts/mysql/Table.ddl	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/resources/dbscripts/mysql/Table.ddl	2019-06-03 16:21:54.752622380 +1000
@@ -15,12 +15,12 @@
 
 -- Each SQL statement in this file should terminate with a semicolon (;)
 -- Lines starting with the pound character (--) are considered as comments
--- DROP TABLE holdingejb;
--- DROP TABLE accountprofileejb;
--- DROP TABLE quoteejb;
--- DROP TABLE keygenejb;
--- DROP TABLE accountejb;
--- DROP TABLE orderejb;
+DROP TABLE holdingejb;
+DROP TABLE accountprofileejb;
+DROP TABLE quoteejb;
+DROP TABLE keygenejb;
+DROP TABLE accountejb;
+DROP TABLE orderejb;
 
 CREATE TABLE holdingejb
   (PURCHASEPRICE DECIMAL(14, 2),
diff -urN daytrader/javaee6/modules/web/src/main/resources/dbscripts/other/Table.ddl /home/ruic/daytrader/javaee6/modules/web/src/main/resources/dbscripts/other/Table.ddl
--- daytrader/javaee6/modules/web/src/main/resources/dbscripts/other/Table.ddl	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/resources/dbscripts/other/Table.ddl	2019-06-03 16:21:54.704622804 +1000
@@ -93,13 +93,6 @@
 ALTER TABLE ORDEREJB
   ADD CONSTRAINT PK_ORDEREJB PRIMARY KEY (ORDERID);
 
-ALTER TABLE HOLDINGEJB VOLATILE;
-ALTER TABLE ACCOUNTPROFILEEJB VOLATILE;
-ALTER TABLE QUOTEEJB VOLATILE;
-ALTER TABLE KEYGENEJB VOLATILE;
-ALTER TABLE ACCOUNTEJB VOLATILE;
-ALTER TABLE ORDEREJB VOLATILE;
-
 CREATE INDEX ACCOUNT_USERID ON ACCOUNTEJB(PROFILE_USERID);
 CREATE INDEX HOLDING_ACCOUNTID ON HOLDINGEJB(ACCOUNT_ACCOUNTID);
 CREATE INDEX ORDER_ACCOUNTID ON ORDEREJB(ACCOUNT_ACCOUNTID);
diff -urN daytrader/javaee6/modules/web/src/main/webapp/account.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/account.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/account.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/account.jsp	2019-06-03 16:21:56.120610288 +1000
@@ -40,7 +40,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10" colspan=5><B><FONT
                 color="#ffffff">DayTrader Account</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
         <TR align="left">
             <TD><B><A href="app?action=home">Home</A></B><B> </B></TD>
@@ -58,6 +58,7 @@
         <%
 boolean showAllOrders = request.getParameter("showAllOrders") == null ? false
                     : true;
+System.out.println("showAllOrders: " + showAllOrders);
             Collection closedOrders = (Collection) request
                     .getAttribute("closedOrders");
             if ((closedOrders != null) && (closedOrders.size() > 0)) {
@@ -191,8 +192,6 @@
                                 <%Iterator it = orderDataBeans.iterator();
             int count = 0;
             while (it.hasNext()) {
-                if ((showAllOrders == false) && (count++ >= 5))
-                    break;
                 OrderDataBean orderData = (OrderDataBean) it.next();
 
                 %>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/dbscripts/mysql/Table.ddl /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/dbscripts/mysql/Table.ddl
--- daytrader/javaee6/modules/web/src/main/webapp/dbscripts/mysql/Table.ddl	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/dbscripts/mysql/Table.ddl	2019-06-03 16:21:56.036611031 +1000
@@ -15,12 +15,12 @@
 
 # Each SQL statement in this file should terminate with a semicolon (;)
 # Lines starting with the pound character (#) are considered as comments
-DROP TABLE holdingejb;
-DROP TABLE accountprofileejb;
-DROP TABLE quoteejb;
-DROP TABLE keygenejb;
-DROP TABLE accountejb;
-DROP TABLE orderejb;
+DROP TABLE IF EXISTS holdingejb;
+DROP TABLE IF EXISTS quoteejb;
+DROP TABLE IF EXISTS keygenejb;
+DROP TABLE IF EXISTS accountejb;
+DROP TABLE IF EXISTS orderejb;
+DROP TABLE IF EXISTS accountprofileejb;
 
 CREATE TABLE holdingejb
   (PURCHASEPRICE DECIMAL(14, 2),
diff -urN daytrader/javaee6/modules/web/src/main/webapp/dbscripts/other/Table.ddl /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/dbscripts/other/Table.ddl
--- daytrader/javaee6/modules/web/src/main/webapp/dbscripts/other/Table.ddl	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/dbscripts/other/Table.ddl	2019-06-03 16:21:55.980611527 +1000
@@ -93,13 +93,6 @@
 ALTER TABLE ORDEREJB
   ADD CONSTRAINT PK_ORDEREJB PRIMARY KEY (ORDERID);
 
-ALTER TABLE HOLDINGEJB VOLATILE;
-ALTER TABLE ACCOUNTPROFILEEJB VOLATILE;
-ALTER TABLE QUOTEEJB VOLATILE;
-ALTER TABLE KEYGENEJB VOLATILE;
-ALTER TABLE ACCOUNTEJB VOLATILE;
-ALTER TABLE ORDEREJB VOLATILE;
-
 CREATE INDEX ACCOUNT_USERID ON ACCOUNTEJB(PROFILE_USERID);
 CREATE INDEX HOLDING_ACCOUNTID ON HOLDINGEJB(ACCOUNT_ACCOUNTID);
 CREATE INDEX ORDER_ACCOUNTID ON ORDEREJB(ACCOUNT_ACCOUNTID);
diff -urN daytrader/javaee6/modules/web/src/main/webapp/header.html /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/header.html
--- daytrader/javaee6/modules/web/src/main/webapp/header.html	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/header.html	2019-06-03 16:21:56.108610394 +1000
@@ -20,6 +20,7 @@
 <meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
 </head>
 <body bgcolor="#FFFFFF" leftmargin="0" topmargin="0" marginwidth="0" marginheight="0">
+	<jsp:include page="WEB-INF/hostname.jspf" />
 <!-- ImageReady Slices (daytrader2_matts_mods.psd - Slices: 00, about, bottomRedBar, configuration, copyRight, dayTraderLogo.gif, daytrader2_matts_mods_14, faq, home, primitives, reports, topRedBar, tradingAndPortfolios) -->
 <table id="Table_01" width="785" height="90" border="0" cellpadding="0" cellspacing="0">
 	<tr>
@@ -42,7 +43,7 @@
 					<td width="1" height="29">
 						<img src="images/spacer.gif" width="1" height="29" alt=""></td>
 					<td>
-						<a href="app" target="TradeMainContent"
+						<a href="app?action=home" target="TradeMainContent"
 							onmouseover="window.status='Select this tab to log on and trade portfolios.  Users are u:n and passwords are xxx';  return true;"
 							onmouseout="window.status='';  return true;">
 							<img src="images/tradingAndPortfolios.gif" width="140" height="29" border="0" alt=""></a></td>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf
--- daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf	2019-06-03 16:21:56.144610075 +1000
@@ -0,0 +1,16 @@
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+  contributor license agreements.  See the NOTICE file distributed with
+  this work for additional information regarding copyright ownership.
+  The ASF licenses this file to You under the Apache License, Version 2.0
+  (the "License"); you may not use this file except in compliance with
+  the License.  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+  Unless required by applicable law or agreed to in writing, software
+  distributed under the License is distributed on an "AS IS" BASIS,
+  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+  See the License for the specific language governing permissions and
+  limitations under the License.
+--><div style="background: yellow;">Hostname: <%= java.net.InetAddress.getLocalHost().getHostName() %></div>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf.rej /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf.rej
--- daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf.rej	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/hostname.jspf.rej	2019-06-03 16:21:55.856612621 +1000
@@ -0,0 +1,19 @@
+***************
+*** 0 ****
+--- 1,16 ----
++ <!--
++  Licensed to the Apache Software Foundation (ASF) under one or more
++   contributor license agreements.  See the NOTICE file distributed with
++   this work for additional information regarding copyright ownership.
++   The ASF licenses this file to You under the Apache License, Version 2.0
++   (the "License"); you may not use this file except in compliance with
++   the License.  You may obtain a copy of the License at
++ 
++       http://www.apache.org/licenses/LICENSE-2.0
++ 
++   Unless required by applicable law or agreed to in writing, software
++   distributed under the License is distributed on an "AS IS" BASIS,
++   WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
++   See the License for the specific language governing permissions and
++   limitations under the License.
++ --><div style="background: yellow;">Hostname: <%= java.net.InetAddress.getLocalHost().getHostName() %></div>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/order.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/order.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/order.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/order.jsp	2019-06-03 16:21:55.844612728 +1000
@@ -31,7 +31,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10" colspan=5><B><FONT
                 color="#ffffff">DayTrader New Orders</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
         <TR align="left">
             <TD><B><A href="app?action=home">Home</A></B><B> </B></TD>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/portfolio.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/portfolio.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/portfolio.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/portfolio.jsp	2019-06-03 16:21:54.836621638 +1000
@@ -32,7 +32,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10" colspan=5><B><FONT
                 color="#ffffff">DayTrader Portfolio</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
         <TR align="left">
             <TD><B><A href="app?action=home">Home</A></B><B> </B></TD>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/quoteImg.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/quoteImg.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/quoteImg.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/quoteImg.jsp	2019-06-03 16:21:55.880612410 +1000
@@ -33,7 +33,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10" colspan=5><B><FONT
                 color="#ffffff">DayTrader Quotes</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
         <TR align="left">
             <TD><A href="app?action=home"><IMG src="images/menuHome.gif" width="80"
diff -urN daytrader/javaee6/modules/web/src/main/webapp/quote.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/quote.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/quote.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/quote.jsp	2019-06-03 16:21:54.816621814 +1000
@@ -31,7 +31,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10" colspan=5><B><FONT
                 color="#ffffff">DayTrader Quotes</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
         <TR align="left">
             <TD><B><A href="app?action=home">Home</A></B><B> </B></TD>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/register.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/register.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/register.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/register.jsp	2019-06-03 16:21:55.896612268 +1000
@@ -38,7 +38,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10"><B><FONT
                 color="#ffffff">DayTrader Register</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
     </TBODY>
 </TABLE>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/tradehome.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/tradehome.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/tradehome.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/tradehome.jsp	2019-06-03 16:21:54.936620754 +1000
@@ -37,7 +37,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10" colspan=5><B><FONT
                 color="#ffffff">DayTrader Home</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
         <TR align="left">
             <TD><B><A href="app?action=home">Home</A></B><B> </B></TD>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/geronimo-web.xml /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/geronimo-web.xml
--- daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/geronimo-web.xml	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/geronimo-web.xml	1970-01-01 10:00:00.000000000 +1000
@@ -1,147 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-
-<!--
-    Licensed to the Apache Software Foundation (ASF) under one or more
-    contributor license agreements.  See the NOTICE file distributed with
-    this work for additional information regarding copyright ownership.
-    The ASF licenses this file to You under the Apache License, Version 2.0
-    (the "License"); you may not use this file except in compliance with
-    the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-    Unless required by applicable law or agreed to in writing, software
-    distributed under the License is distributed on an "AS IS" BASIS,
-    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-    See the License for the specific language governing permissions and
-    limitations under the License.
--->
-
-    <web-app xmlns="http://geronimo.apache.org/xml/ns/j2ee/web-2.0.1"
-             xmlns:naming="http://geronimo.apache.org/xml/ns/naming-1.2"
-             xmlns:sys="http://geronimo.apache.org/xml/ns/deployment-1.2">
-        
-        <sys:environment>
-            <sys:moduleId>
-                <sys:groupId>${project.groupId}</sys:groupId>
-                <sys:artifactId>${project.artifactId}</sys:artifactId>
-                <sys:version>${project.version}</sys:version>
-                <sys:type>car</sys:type>
-            </sys:moduleId>
-        
-            <!--<sys:dependencies>
-                <sys:dependency>
-                    <sys:groupId>org.apache.geronimo.samples.daytrader.plugins</sys:groupId>
-                    <sys:artifactId>daytrader-derby-datasource</sys:artifactId>
-                    <sys:version>${project.version}</sys:version>
-                    <sys:type>car</sys:type>
-                </sys:dependency>
-            </sys:dependencies>-->
-        </sys:environment>
-    
-    <context-root>/${project.artifactId}</context-root>
-
-    <naming:resource-ref>
-        <naming:ref-name>jdbc/TradeDataSource</naming:ref-name>
-        <naming:resource-link>jdbc/TradeDataSource</naming:resource-link>
-    </naming:resource-ref>
-
-    <naming:resource-ref>
-        <naming:ref-name>jdbc/NoTxTradeDataSource</naming:ref-name>
-        <naming:resource-link>jdbc/NoTxTradeDataSource</naming:resource-link>
-    </naming:resource-ref>
-
-    <gbean name="DBInitialization" class="org.apache.geronimo.connector.wrapper.DatabaseInitializationGBean">
-        <!--sql override path
-        <attribute name="sql">
-create table OPENJPASEQ
-(ID SMALLINT NOT NULL PRIMARY KEY,
-SEQUENCE_VALUE BIGINT);
-
-CREATE TABLE HOLDINGEJB
-  (PURCHASEPRICE DECIMAL(14, 2),
-   HOLDINGID INTEGER NOT NULL,
-   QUANTITY DOUBLE NOT NULL,
-   PURCHASEDATE TIMESTAMP,
-   ACCOUNT_ACCOUNTID INTEGER,
-   QUOTE_SYMBOL VARCHAR(250));
-
-ALTER TABLE HOLDINGEJB
-  ADD CONSTRAINT PK_HOLDINGEJB PRIMARY KEY (HOLDINGID);
-
-CREATE TABLE ACCOUNTPROFILEEJB
-  (ADDRESS VARCHAR(250),
-   PASSWD VARCHAR(250),
-   USERID VARCHAR(250) NOT NULL,
-   EMAIL VARCHAR(250),
-   CREDITCARD VARCHAR(250),
-   FULLNAME VARCHAR(250));
-
-ALTER TABLE ACCOUNTPROFILEEJB
-  ADD CONSTRAINT PK_ACCOUNTPROFILE2 PRIMARY KEY (USERID);
-
-CREATE TABLE QUOTEEJB
-  (LOW DECIMAL(14, 2),
-   OPEN1 DECIMAL(14, 2),
-   VOLUME DOUBLE NOT NULL,
-   PRICE DECIMAL(14, 2),
-   HIGH DECIMAL(14, 2),
-   COMPANYNAME VARCHAR(250),
-   SYMBOL VARCHAR(250) NOT NULL,
-   CHANGE1 DOUBLE NOT NULL);
-
-ALTER TABLE QUOTEEJB
-  ADD CONSTRAINT PK_QUOTEEJB PRIMARY KEY (SYMBOL);
-
-CREATE TABLE KEYGENEJB
-  (KEYVAL INTEGER NOT NULL,
-   KEYNAME VARCHAR(250) NOT NULL);
-
-ALTER TABLE KEYGENEJB
-  ADD CONSTRAINT PK_KEYGENEJB PRIMARY KEY (KEYNAME);
-
-CREATE TABLE ACCOUNTEJB
-  (CREATIONDATE TIMESTAMP,
-   OPENBALANCE DECIMAL(14, 2),
-   LOGOUTCOUNT INTEGER NOT NULL,
-   BALANCE DECIMAL(14, 2),
-   ACCOUNTID INTEGER NOT NULL,
-   LASTLOGIN TIMESTAMP,
-   LOGINCOUNT INTEGER NOT NULL,
-   PROFILE_USERID VARCHAR(250));
-
-ALTER TABLE ACCOUNTEJB
-  ADD CONSTRAINT PK_ACCOUNTEJB PRIMARY KEY (ACCOUNTID);
-
-CREATE TABLE ORDEREJB
-  (ORDERFEE DECIMAL(14, 2),
-   COMPLETIONDATE TIMESTAMP,
-   ORDERTYPE VARCHAR(250),
-   ORDERSTATUS VARCHAR(250),
-   PRICE DECIMAL(14, 2),
-   QUANTITY DOUBLE NOT NULL,
-   OPENDATE TIMESTAMP,
-   ORDERID INTEGER NOT NULL,
-   ACCOUNT_ACCOUNTID INTEGER,
-   QUOTE_SYMBOL VARCHAR(250),
-   HOLDING_HOLDINGID INTEGER);
-
-ALTER TABLE ORDEREJB
-  ADD CONSTRAINT PK_ORDEREJB PRIMARY KEY (ORDERID);
-
-CREATE INDEX ACCOUNT_USERID ON ACCOUNTEJB(PROFILE_USERID);
-CREATE INDEX HOLDING_ACCOUNTID ON HOLDINGEJB(ACCOUNT_ACCOUNTID);
-CREATE INDEX ORDER_ACCOUNTID ON ORDEREJB(ACCOUNT_ACCOUNTID);
-CREATE INDEX ORDER_HOLDINGID ON ORDEREJB(HOLDING_HOLDINGID);
-CREATE INDEX CLOSED_ORDERS ON ORDEREJB(ACCOUNT_ACCOUNTID,ORDERSTATUS);
-        </attribute>-->
-        <!-- According to your database vendor, you can put these values: db2, oracle, informix, mysql, sqlserver, postgre, other(means any other vendor)-->
-        <attribute name="path">/dbscripts/derby/Table.ddl</attribute>
-        <reference name="DataSource">
-            <name>jdbc/NoTxTradeDataSource</name>
-        </reference>
-    </gbean>
-
-</web-app>
-
-
diff -urN daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xmi /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xmi
--- daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xmi	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xmi	1970-01-01 10:00:00.000000000 +1000
@@ -1,26 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-    Licensed to the Apache Software Foundation (ASF) under one or more
-    contributor license agreements.  See the NOTICE file distributed with
-    this work for additional information regarding copyright ownership.
-    The ASF licenses this file to You under the Apache License, Version 2.0
-    (the "License"); you may not use this file except in compliance with
-    the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-    Unless required by applicable law or agreed to in writing, software
-    distributed under the License is distributed on an "AS IS" BASIS,
-    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-    See the License for the specific language governing permissions and
-    limitations under the License.
--->
-<webappbnd:WebAppBinding xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:webappbnd="webappbnd.xmi" xmi:id="WebAppBinding_1253388157906" virtualHostName="default_host">
-  <webapp href="WEB-INF/web.xml#WebApp_ID"/>
-  <resRefBindings xmi:id="ResourceRefBinding_1253420979765">
-    <bindingResourceRef href="WEB-INF/web.xml#ResourceRef_1253420979765"/>
-  </resRefBindings>
-  <resRefBindings xmi:id="ResourceRefBinding_1254017954671">
-    <bindingResourceRef href="WEB-INF/web.xml#ResourceRef_1254017954671"/>
-  </resRefBindings>
-</webappbnd:WebAppBinding>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xml /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xml
--- daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xml	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-bnd.xml	1970-01-01 10:00:00.000000000 +1000
@@ -1,30 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-
-    Licensed to the Apache Software Foundation (ASF) under one or more
-    contributor license agreements.  See the NOTICE file distributed with
-    this work for additional information regarding copyright ownership.
-    The ASF licenses this file to You under the Apache License, Version 2.0
-    (the "License"); you may not use this file except in compliance with
-    the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-    Unless required by applicable law or agreed to in writing, software
-    distributed under the License is distributed on an "AS IS" BASIS,
-    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-    See the License for the specific language governing permissions and
-    limitations under the License.
-
--->
-<web-bnd 
-    xmlns="http://websphere.ibm.com/xml/ns/javaee"
-    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
-    xsi:schemaLocation="http://websphere.ibm.com/xml/ns/javaee http://websphere.ibm.com/xml/ns/javaee/ibm-web-bnd_1_0.xsd"
-    version="1.0">
-
-    <virtual-host name="default_host" />
-
-    <resource-ref name="jdbc/TradeDataSource" binding-name="jdbc/TradeDataSource"></resource-ref>
-
-</web-bnd>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-ext.xmi /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-ext.xmi
--- daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-ext.xmi	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/ibm-web-ext.xmi	1970-01-01 10:00:00.000000000 +1000
@@ -1,20 +0,0 @@
-<?xml version="1.0" encoding="UTF-8"?>
-<!--
-    Licensed to the Apache Software Foundation (ASF) under one or more
-    contributor license agreements.  See the NOTICE file distributed with
-    this work for additional information regarding copyright ownership.
-    The ASF licenses this file to You under the Apache License, Version 2.0
-    (the "License"); you may not use this file except in compliance with
-    the License.  You may obtain a copy of the License at
-
-       http://www.apache.org/licenses/LICENSE-2.0
-
-    Unless required by applicable law or agreed to in writing, software
-    distributed under the License is distributed on an "AS IS" BASIS,
-    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
-    See the License for the specific language governing permissions and
-    limitations under the License.
--->
-<webappext:WebAppExtension xmi:version="2.0" xmlns:xmi="http://www.omg.org/XMI" xmlns:webappext="webappext.xmi" xmi:id="WebAppExtension_1253388157890" reloadInterval="3" reloadingEnabled="true" additionalClassPath="" fileServingEnabled="true" directoryBrowsingEnabled="false" serveServletsByClassnameEnabled="true">
-  <webApp href="WEB-INF/web.xml#WebApp_ID"/>
-</webappext:WebAppExtension>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml
--- daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml	2019-06-03 16:21:55.804613081 +1000
@@ -0,0 +1,36 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+    
+    http://www.apache.org/licenses/LICENSE-2.0
+    
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
+<!DOCTYPE jbosscmp-jdbc PUBLIC "-//JBoss//DTD JBOSSCMP-JDBC 4.0//EN" "http://www.jboss.org/j2ee/dtd/jbosscmp-jdbc_4_0.dtd">
+<jbosscmp-jdbc>
+
+    <defaults>
+        <datasource>java:IS346DS</datasource>
+        <datasource-mapping>mySQL</datasource-mapping>
+    </defaults>
+
+    <enterprise-beans>
+        <entity>
+            <ejb-name>Track</ejb-name>
+            <cmp-field>
+                <field-name>id</field-name>
+                <auto-increment />
+            </cmp-field>
+            <entity-command name="get-generated-keys" class="org.jboss.ejb.plugins.cmp.jdbc.keygen.JDBC30GeneratedKeysCreateCommand" />
+        </entity>
+    </enterprise-beans>
+</jbosscmp-jdbc>
\ No newline at end of file
diff -urN daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml.rej /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml.rej
--- daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml.rej	1970-01-01 10:00:00.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/jbosscmp-jdbc.xml.rej	2019-06-03 16:21:55.768613399 +1000
@@ -0,0 +1,39 @@
+***************
+*** 0 ****
+--- 1,36 ----
++ <?xml version="1.0" encoding="UTF-8"?>
++ <!--
++     Licensed to the Apache Software Foundation (ASF) under one or more
++     contributor license agreements.  See the NOTICE file distributed with
++     this work for additional information regarding copyright ownership.
++     The ASF licenses this file to You under the Apache License, Version 2.0
++     (the "License"); you may not use this file except in compliance with
++     the License.  You may obtain a copy of the License at
++     
++     http://www.apache.org/licenses/LICENSE-2.0
++     
++     Unless required by applicable law or agreed to in writing, software
++     distributed under the License is distributed on an "AS IS" BASIS,
++     WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
++     See the License for the specific language governing permissions and
++     limitations under the License.
++ -->
++ <!DOCTYPE jbosscmp-jdbc PUBLIC "-//JBoss//DTD JBOSSCMP-JDBC 4.0//EN" "http://www.jboss.org/j2ee/dtd/jbosscmp-jdbc_4_0.dtd">
++ <jbosscmp-jdbc>
++ 
++     <defaults>
++         <datasource>java:IS346DS</datasource>
++         <datasource-mapping>mySQL</datasource-mapping>
++     </defaults>
++ 
++     <enterprise-beans>
++         <entity>
++             <ejb-name>Track</ejb-name>
++             <cmp-field>
++                 <field-name>id</field-name>
++                 <auto-increment />
++             </cmp-field>
++             <entity-command name="get-generated-keys" class="org.jboss.ejb.plugins.cmp.jdbc.keygen.JDBC30GeneratedKeysCreateCommand" />
++         </entity>
++     </enterprise-beans>
++ </jbosscmp-jdbc>
\ No newline at end of file
diff -urN daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/web.xml /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/web.xml
--- daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/web.xml	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/WEB-INF/web.xml	2019-06-03 16:21:55.796613152 +1000
@@ -19,25 +19,22 @@
 <web-app xmlns="http://java.sun.com/xml/ns/javaee" version="3.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
     xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_3_0.xsd">
 
+	<distributable/>
+
     <display-name>DayTrader Web JDBC</display-name>
-   <module-name>web</module-name>
     <servlet>
-        <display-name>register</display-name>
         <servlet-name>register</servlet-name>
         <jsp-file>/register.jsp</jsp-file>
     </servlet>   
     <servlet>
-        <display-name>welcome</display-name>
         <servlet-name>welcome</servlet-name>
         <jsp-file>/welcome.jsp</jsp-file>
     </servlet>
     <servlet>
-        <display-name>order</display-name>
         <servlet-name>order</servlet-name>
         <jsp-file>/order.jsp</jsp-file>
     </servlet>
     <servlet>
-        <display-name>tradehome</display-name>
         <servlet-name>tradehome</servlet-name>
         <jsp-file>/tradehome.jsp</jsp-file>
     </servlet>
@@ -83,27 +80,37 @@
         <res-type>javax.sql.DataSource</res-type>
         <res-auth>Container</res-auth>
         <res-sharing-scope>Shareable</res-sharing-scope>
+	<lookup-name>java:/jdbc/TradeDataSource</lookup-name>
     </resource-ref>
-    <resource-ref>
-        <res-ref-name>jdbc/NoTxTradeDataSource</res-ref-name>
-        <res-type>javax.sql.DataSource</res-type>
-        <res-auth>Container</res-auth>
-        <res-sharing-scope>Shareable</res-sharing-scope>
-    </resource-ref>
-   <!--  <resource-ref>
+     <resource-ref>
         <res-ref-name>jms/QueueConnectionFactory</res-ref-name>
         <res-type>javax.jms.QueueConnectionFactory</res-type>
-        <res-auth>Application</res-auth>
-        <res-sharing-scope>Shareable</res-sharing-scope>
+        <res-auth>Container</res-auth>
+	<mapped-name>QueueConnectionFactory</mapped-name> 
+	<lookup-name>java:/ConnectionFactory</lookup-name>
     </resource-ref>
     <resource-ref>
         <res-ref-name>jms/TopicConnectionFactory</res-ref-name>
         <res-type>javax.jms.TopicConnectionFactory</res-type>
-        <res-auth>Application</res-auth>
-        <res-sharing-scope>Shareable</res-sharing-scope>
+        <res-auth>Container</res-auth>
+	<mapped-name>TopicConnectionFactory</mapped-name>
+	<lookup-name>java:/ConnectionFactory</lookup-name>
     </resource-ref>   
-   
-    
+     <resource-ref>
+        <res-ref-name>jms/TradeBrokerQueue</res-ref-name>
+        <res-type>javax.jms.Queue</res-type>
+        <res-auth>Container</res-auth>
+        <lookup-name>java:/queue/TradeBrokerQueue</lookup-name>
+    </resource-ref>
+
+     <resource-ref>
+        <res-ref-name>jms/TradeStreamerTopic</res-ref-name>
+        <res-type>javax.jms.Topic</res-type>
+        <res-auth>Container</res-auth>
+        <lookup-name>java:/topic/TradeStreamerTopic</lookup-name>
+    </resource-ref>
+
+  <!-- 
     
    
     <message-destination-ref>
@@ -117,9 +124,8 @@
         <message-destination-type>javax.jms.Topic</message-destination-type>
         <message-destination-usage>Produces</message-destination-usage>
         <message-destination-link>dt-ejb.jar#jms/TradeStreamerTopic</message-destination-link>
-    </message-destination-ref>-->
-    
-    
+    </message-destination-ref>
+    -->
     <!--  <service-ref>
         <description>WSDL Service Trade</description>
         <service-ref-name>service/Trade</service-ref-name>
diff -urN daytrader/javaee6/modules/web/src/main/webapp/welcome.jsp /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/welcome.jsp
--- daytrader/javaee6/modules/web/src/main/webapp/welcome.jsp	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/modules/web/src/main/webapp/welcome.jsp	2019-06-03 16:21:55.684614142 +1000
@@ -28,7 +28,7 @@
             <TD bgcolor="#c93333" align="left" width="640" height="10"><B><FONT
                 color="#ffffff">DayTrader Login</FONT></B></TD>
             <TD align="center" bgcolor="#000000" width="100" height="10"><FONT
-                color="#ffffff"><B>DayTrader</B></FONT></TD>
+                color="#ffffff"><B><%= java.net.InetAddress.getLocalHost().getHostName() %></B></FONT></TD>
         </TR>
     </TBODY>
 </TABLE>
diff -urN daytrader/javaee6/pom.xml /home/ruic/daytrader/javaee6/pom.xml
--- daytrader/javaee6/pom.xml	2019-06-03 16:20:59.000000000 +1000
+++ /home/ruic/daytrader/javaee6/pom.xml	2019-06-03 16:21:50.132663204 +1000
@@ -1,4 +1,20 @@
 <?xml version="1.0" encoding="UTF-8"?>
+<!--
+    Licensed to the Apache Software Foundation (ASF) under one or more
+    contributor license agreements.  See the NOTICE file distributed with
+    this work for additional information regarding copyright ownership.
+    The ASF licenses this file to You under the Apache License, Version 2.0
+    (the "License"); you may not use this file except in compliance with
+    the License.  You may obtain a copy of the License at
+
+       http://www.apache.org/licenses/LICENSE-2.0
+
+    Unless required by applicable law or agreed to in writing, software
+    distributed under the License is distributed on an "AS IS" BASIS,
+    WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+    See the License for the specific language governing permissions and
+    limitations under the License.
+-->
 <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
   <modelVersion>4.0.0</modelVersion>
   <parent>
@@ -19,4 +35,4 @@
     <module>assemblies</module>
     <module>plans</module>
   </modules>
-</project>
\ No newline at end of file
+</project>
diff -urN daytrader/pom.xml /home/ruic/daytrader/pom.xml
--- daytrader/pom.xml	2019-06-03 16:20:58.000000000 +1000
+++ /home/ruic/daytrader/pom.xml	2019-06-03 16:21:49.944664865 +1000
@@ -20,8 +20,8 @@
 
     <parent>
         <groupId>org.apache.geronimo.genesis</groupId>
-        <artifactId>genesis-java6-flava</artifactId>
-        <version>2.0</version>
+        <artifactId>genesis-default-flava</artifactId>
+        <version>2.3</version>
     </parent>
 
     <groupId>org.apache.geronimo.daytrader</groupId>
@@ -39,7 +39,7 @@
     </scm>
 
     <properties>        
-        <geronimoVersion>3.0.1-SNAPSHOT</geronimoVersion>
+        <geronimoVersion>3.0.1</geronimoVersion>
         <!-- set siteId to artifactId for any "top level" project rooting a website -->
         <siteId>daytrader</siteId>
         <openjpaVersion>2.1.0</openjpaVersion>
@@ -262,7 +262,7 @@
     </dependencyManagement>
 
     <build>
-        <pluginManagement>
+<!--         <pluginManagement>
             <plugins>
                 <plugin>
                     <groupId>org.apache.geronimo.buildsupport</groupId>
@@ -276,7 +276,7 @@
                 
             </plugins>
         </pluginManagement>
-
+ -->
         <plugins>       
 
             <!--<plugin>
@@ -292,6 +292,19 @@
 
     </build>
 
+    <repositories>
+<repository>
+    <id>codehaus.snapshots</id>
+    <url>whatever</url>
+    <snapshots>
+        <enabled>false</enabled>
+    </snapshots>
+    <releases>
+        <enabled>false</enabled>
+    </releases>
+</repository>
+</repositories>
+    
     <pluginRepositories>
         <!-- required for clean build unless you want to bootstrap the car-maven-plugin -->
         <pluginRepository>
@@ -322,7 +335,7 @@
             <modules>
                 <!-- Daytrader Java EE 6 -->
                <module>javaee6</module>  
-               <module>plugins</module> 
+           <!--    <module>plugins</module> --> 
             </modules>
         </profile>
         <profile>
@@ -394,4 +407,4 @@
             </modules>
         </profile>
     </profiles> 
-</project>
\ No newline at end of file
+</project>
